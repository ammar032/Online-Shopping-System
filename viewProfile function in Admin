#include<iostream>
#include<string>
#include<stdlib.h>
using namespace std;

class Profile
{
public:
    string name;
    int age;
    string username;
    string password;

    void registration(string name, int age, string username, string password)
    {
        this->age = age;
        this->name = name;
        this->username = username;
        this->password = password;
    }

    bool login(string loginUsername, string loginPassword)
    {
        if (loginUsername == username && loginPassword == password)
        {
            return true;
        }
        else
        {
            return false;
        }
    }

    friend istream& operator >>(istream& obj, Profile& p1)
    {
        cin.ignore();
        cout << "Enter name: "; getline(obj, p1.name);
        cout << "Enter age: "; obj >> p1.age;
        cout << "Enter username: "; obj >> p1.username;
        cout << "Enter password: "; obj >> p1.password;

        return obj;
    }

    friend ostream& operator <<(ostream& obj, Profile p1)
    {
        obj << "Name: " << p1.name << endl;
        obj << "Age: " << p1.age << endl;
        obj << "Username: " << p1.username << endl;
        obj << "Password: " << p1.password << endl << endl;

        return obj;
    }
};


class Item
{
public:
    string name;
    double itemPrice;
    string itemDescription;
    string owner;

    void setItem(string name, double itemPrice, string itemDescription, string owner)
    {
        this->name = name;
        this->itemPrice = itemPrice;
        this->itemDescription = itemDescription;
        this->owner = owner;
    }

    friend ostream& operator <<(ostream& obj, Item item)
    {
        obj << "\nItem name is: " << item.name << endl;
        obj << "Item price is: " << item.itemPrice << endl;
        obj << "Item Description is: " << item.itemDescription << endl << endl;

        return obj;
    }

    friend istream& operator >>(istream& obj, Item& item)
    {
        cout << "Enter name: "; obj >> item.name;
        cout << "Enter price: "; obj >> item.itemPrice;
        cin.ignore();
        cout << "Enter description: "; getline(obj, item.itemDescription);

        return obj;
    }
};

class Admin : public Profile
{
public:

};

class shopOwner : public Profile
{
public:
};

struct Cart
{
    string item;
    int price;
};

class Customer : public Profile
{
public:
    int total;
    Cart cart[5];

    void buyItem()
    {

    }

    void addToCart()
    {

    }

    void deleteItem()
    {

    }

    void viewCart()
    {

    }

    void buyCart()
    {

    }
};

int main()
{
    Admin admin[5];
    shopOwner owner[5];
    Customer customer[5];
    Item item[5];

    admin[0].registration("ammar", 20, "ammar1", "password1");
    owner[0].registration("hamza", 19, "hamza2", "password2");
    customer[0].registration("sajid", 19, "sajid3", "password3");

    item[0].setItem("Earphones", 500, "Best audio ever", owner[0].name);

    int numberOfAdmins = 1;
    int numberOfOwners = 1;
    int numberOfCustomers = 1;
    int numberOfItems = 1;
    int numberOfCartItems = 0;

a:
    int option;
    cout << "\tMAIN MENU\n1. Login\n2. Create Account\n3. Exit\nOPTION: ";
    cin >> option;
    system("cls");

    string loginUsername;
    string loginPassword;
    int user;
    char status = '0';

    switch (option)
    {
    case 1:

        cin.ignore();

        //temp code for easily logging in 
        //uncomment this and comment the other one for the normal version

        /*int login;
        cout << "\tLOGIN\n1. Admin\n2. Shop Owner\n3. Customer\nOPTION: ";
        cin >> login;*/
        
       /* if (login == 1)
        {
            loginUsername = admin[0].username;
            loginPassword = admin[0].password;
        }
        else if (login == 2)
        {
            loginUsername = owner[0].username;
            loginPassword = owner[0].password;
        }
        else if (login == 3)
        {
            loginUsername = customer[0].username;
            loginPassword = customer[0].password;
        }*/

        //comment this for easily logging in
        cout << "Username: "; cin >> loginUsername;
        cout << "Password: "; cin >> loginPassword;


        for (int i = 0; i < numberOfAdmins; i++)
        {
            if (admin[i].login(loginUsername, loginPassword))
            {
                status = 'A';
                user = i;
            }
        }

        for (int i = 0; i < numberOfOwners; i++)
        {
            if (owner[i].login(loginUsername, loginPassword))
            {
                status = 'O';
                user = i;
            }
        }

        for (int i = 0; i < numberOfCustomers; i++)
        {
            if (customer[i].login(loginUsername, loginPassword))
            {
                status = 'C';
                user = i;
            }
        }


        system("cls");
        cout << "You have successfully logged in\n";

        switch (status)
        {
        case 'A':
        c:

            int adminOption;
            cout << "\tADMIN\n1. View Profiles\n2. Delete Profile\n3. Back To Main Menu\nOPTION: ";
            cin >> adminOption;

            switch (adminOption)
            {
            case 1:

                cout << "\n\tADMIN\n";
                for (int i = 0; i < numberOfAdmins; i++)
                {
                    cout << admin[i];
                }

                cout << "\tSHOP OWNERS\n";
                for (int i = 0; i < numberOfOwners; i++)
                {
                    cout << owner[i];
                }

                cout << "\tCUSTOMERS\n";
                for (int i = 0; i < numberOfCustomers; i++)
                {
                    cout << customer[i];
                }

                int goBack;
                cout << "Press 1 to go back: "; cin >> goBack;

                system("cls");
                goto a;

            case 2:
            case 3:
                system("cls");
                goto a;

            default:
                system("cls");
                cout << "Invalid option\n";
                goto c;
            }

            break;

        case 'O':
        d:

            int ownerOption;
            cout << "\tSHOP OWNER\n1. Display Items\n2. Add Item\n3. Remove Item\n4. Back To Main Menu\nOPTION: ";
            cin >> ownerOption;

            switch (ownerOption)
            {
            case 1:
                for (int i = 0; i < numberOfItems; i++)
                {
                    if (item[i].owner == owner[user].name)
                    {
                        cout << item[i];
                    }
                }

                cout << endl;
                goto d;

            case 2:
                cin >> item[numberOfItems];
                item[numberOfItems].owner = owner[user].name;
                numberOfItems++;

                system("cls");
                cout << "Item successfully added\n";
                goto d;

            case 3:
                for (int i = 0; i < numberOfItems; i++)
                {
                    if (item[i].owner == owner[user].name)
                    {
                        cout << i << ". " << item[i].name<<endl;
                    }
                }
                int itemNumber;
                cout << "Which item do you want to delete: "; cin >> itemNumber;

                item[itemNumber].setItem("REMOVED", 0, "REMOVED", owner[user].name);

                system("cls");
                cout << "Item successfully removed\n";
                goto d;

            case 4:
                system("cls");
                goto a;

            default:
                system("cls");
                cout << "Invalid option\n";
                goto d;
            }

            break;

        case 'C':
        e:

            int customerOption;
            cout << "\tCUSTOMER\n1. View Items\n2. View Cart\n3. Back To Main Menu\nOPTION: ";
            cin >> customerOption;

            switch (customerOption)
            {
            case 1:
                for (int i = 0; i < numberOfItems; i++)
                {
                    cout << item[i];
                }

                int itemSelection;
                for (int i = 0; i < numberOfItems; i++)
                {
                    cout << i << ". " << item[i].name << endl;
                }
                cout << "\nSelect item: "; cin >> itemSelection;
                
                system("cls");
                cout << item[itemSelection];

                int option;
                cout << "Do you want to: \n1. Buy Item\n2. Add To Cart\n3. Add To Wishlist\n4. Go Back\nOPTION: ";
                cin >> option;

                switch (option)
                {
                case 1:
                    system("cls");
                    cout << item[itemSelection].name << " " << item[itemSelection].itemPrice<<" Rs\n";
                    customer[user].total = item[itemSelection].itemPrice;
                    cout << "Total = " << customer[user].total<<endl;

                    int payment;
                    cout << "Would you like to pay with cash or credit?\n1. Cash\n2. Credit\nOPTION: ";
                    cin >> payment;
                    if (payment == 1)
                    {
                        system("cls");
                        int confirmation;
                        cout << "Please confirm your payment of " << customer[user].total<<" Rs\n1. Confirm\n2. Go Back\nOPTION: ";
                        cin >> confirmation;

                        if (confirmation == 1)
                        {
                            system("cls");
                            cout << "Cash Payment Successful!\n";
                            int option;
                            cout << "Would you like to buy anything else or exit\n1. Go To Customer Menu\n2. Exit\nOPTION: ";
                            cin >> option;

                            if (option == 1)
                            {
                                goto e;
                            }
                            else
                            {
                                goto z;
                            }
                        }
                    }
                    else if(payment == 2)
                    {
                        system("cls");
                        cout << "Card Payment Successful!\n"; // gonna add card details and ask the user
                        int option;
                        cout << "Would you like to buy anything else or exit\n1. Go To Customer Menu\n2. Exit\nOPTION: ";
                        cin >> option;

                        if (option == 1)
                        {
                            goto e;
                        }
                        else
                        {
                            goto z;
                        }
                    }

                case 2:
                    customer[user].cart[0].item = item[itemSelection].name;
                    customer[user].cart[0].price = item[itemSelection].itemPrice;

                    system("cls");
                    cout << "Item successfully added to cart.\n";
                    numberOfCartItems++;
                    goto e;

                case 3:
                case 4:
                default:
                    cout << "Invalid choice";
                    break;
                }

            case 2:

                for (int i = 0; i < numberOfCartItems; i++)
                {
                    cout << customer[user].cart[i].item<<endl;
                    cout << customer[user].cart[i].price << endl;
                }

                int goBack;
                cout << "\nPress 1 to go back: "; cin >> goBack; //will add conditions
                system("cls");
                goto e;

            case 3:
                system("cls");
                goto a;

            default:
                system("cls");
                cout << "Invalid option\n";
                goto e;
            }

            break;

        default:
            system("cls");
            cout << "Invalid credentials please login again\n";
            goto a;
        }

        break;

    case 2:
    b:

        int option;
        cout << "\tACCOUNT CREATION\n";
        cout << "Do you want to make an account for: \n1. Admin\n2. Shop Owner\n3. Customer\nOPTION: ";
        cin >> option;

        switch (option)
        {
        case 1:
            cin >> admin[numberOfAdmins++];
            system("cls");
            cout << "Account successfully created now please login\n";
            goto a;

        case 2:
            cin >> owner[numberOfOwners++];
            system("cls");
            cout << "Account successfully created now please login\n";
            goto a;

        case 3:
            cin >> customer[numberOfCustomers++];
            system("cls");
            cout << "Account successfully created now please login\n";
            goto a;

        default:
            system("cls");
            cout << "Invalid option please select one of the options below\n";
            goto b;
        }

        break;

    case 3:
    z:

        cout << "\nProgram Ended Successfully";
        break;

    default:
        system("cls");
        cout << "Invalid option\n";
        goto a;
    }
}
